\hypertarget{book__commands_8py}{}\doxysection{handlers/book\+\_\+commands.py File Reference}
\label{book__commands_8py}\index{handlers/book\_commands.py@{handlers/book\_commands.py}}


Handlers that manipulate the bookings.  


\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{book__commands_8py_a726c2ca54e78088db58ddd26ad01f4bc}{book\+\_\+commands.\+select\+\_\+fair}} (Update update, Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE context)
\begin{DoxyCompactList}\small\item\em I\+N\+IT state for /fairs, /events and /book. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{book__commands_8py_a86f5df99897bf0dcdf8731fb6703d965}{book\+\_\+commands.\+show\+\_\+fair\+\_\+description}} (Update update, Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE context)
\begin{DoxyCompactList}\small\item\em S\+T\+A\+TE 0 for /fairs. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{book__commands_8py_ac90283b7b1597174965e082c937fbb4d}{book\+\_\+commands.\+select\+\_\+event}} (Update update, Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE context)
\begin{DoxyCompactList}\small\item\em S\+T\+A\+TE 0 for /events and /book. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{book__commands_8py_a2610898bb910a07caec0db18e6e0b5a9}{book\+\_\+commands.\+show\+\_\+event\+\_\+description}} (Update update, Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE context)
\begin{DoxyCompactList}\small\item\em S\+T\+A\+TE 1 for /events. \end{DoxyCompactList}\item 
None \mbox{\hyperlink{book__commands_8py_a80fcbff7625c75bc6dd2239369e80659}{book\+\_\+commands.\+whoami}} (Update update, Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE context)
\begin{DoxyCompactList}\small\item\em Command handler for /whoami. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{book__commands_8py_a20dd564a06bfeb9af69afe9a384ec03c}{book\+\_\+commands.\+select\+\_\+slot\+\_\+date}} (Update update, Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE context)
\begin{DoxyCompactList}\small\item\em S\+T\+A\+TE 1 for /book. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{book__commands_8py_a0f132a7d6cf7d7f10f6a3282e7e08dd2}{book\+\_\+commands.\+select\+\_\+slot\+\_\+time}} (Update update, Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE context)
\begin{DoxyCompactList}\small\item\em S\+T\+A\+TE 2 for /book. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{book__commands_8py_a39fbaf1f19cdf996f5249c2f4b1a4f23}{book\+\_\+commands.\+book\+\_\+event}} (Update update, Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE context)
\begin{DoxyCompactList}\small\item\em S\+T\+A\+TE 3 for /book. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{book__commands_8py_abe121e3ead63c8f0e343f7ae041dad23}{book\+\_\+commands.\+select\+\_\+slot\+\_\+for\+\_\+user}} (Update update, Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE context)
\begin{DoxyCompactList}\small\item\em I\+N\+IT state for /unbook. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{book__commands_8py_a56f6b010842cf27c0a8393ba3edfb696}{book\+\_\+commands.\+confirm\+\_\+unbook\+\_\+slot}} (Update update, Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE context)
\begin{DoxyCompactList}\small\item\em S\+T\+A\+TE 0 for /unbook. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{book__commands_8py_abb709437370f97838ddc485fdc6b28aa}{book\+\_\+commands.\+unbook\+\_\+slot}} (Update update, Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE context)
\begin{DoxyCompactList}\small\item\em S\+T\+A\+TE 1 for /unbook. \end{DoxyCompactList}\item 
None \mbox{\hyperlink{book__commands_8py_a8e1218c0f66e55536b63b1b3aefc148d}{book\+\_\+commands.\+my\+\_\+bookings}} (Update update, Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE context)
\begin{DoxyCompactList}\small\item\em Command handler for /mybookings. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{book__commands_8py_a51f53a4306da8196a3bd0fbf30026f7d}\label{book__commands_8py_a51f53a4306da8196a3bd0fbf30026f7d}} 
{\bfseries book\+\_\+commands.\+db} = os.\+getenv(\char`\"{}D\+B\+\_\+\+P\+A\+TH\char`\"{})
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Handlers that manipulate the bookings. 

This file contains the implementation of the Telegram Bot Handlers that manage the lifecycle of the bookings associated to them, as well as the handlers that retrieve information about all events and fairs. They are triggered by the following commands\+: {\ttfamily /fairs}, {\ttfamily /events}, {\ttfamily /whoami} {\ttfamily /book}, {\ttfamily /unbook}, {\ttfamily /mybookings}. 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{book__commands_8py_a39fbaf1f19cdf996f5249c2f4b1a4f23}\label{book__commands_8py_a39fbaf1f19cdf996f5249c2f4b1a4f23}} 
\index{book\_commands.py@{book\_commands.py}!book\_event@{book\_event}}
\index{book\_event@{book\_event}!book\_commands.py@{book\_commands.py}}
\doxysubsubsection{\texorpdfstring{book\_event()}{book\_event()}}
{\footnotesize\ttfamily  int book\+\_\+commands.\+book\+\_\+event (\begin{DoxyParamCaption}\item[{Update}]{update,  }\item[{Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE}]{context }\end{DoxyParamCaption})}



S\+T\+A\+TE 3 for /book. 


\begin{DoxyParams}{Parameters}
{\em update} & Update, Telegram parameters \\
\hline
{\em context} & Context\+Types, library status \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integer, the next state
\end{DoxyReturn}
S\+T\+A\+TE 3 for the {\ttfamily /book} command.

Expected callback pattern (as Reg\+Ex)\+: {\ttfamily $^\wedge$slot\+\_\+id\+:\mbox{[}0-\/9\mbox{]}$\ast$\$}

This function books a slot for the user and logs its information, then terminates the conversation. \mbox{\Hypertarget{book__commands_8py_a56f6b010842cf27c0a8393ba3edfb696}\label{book__commands_8py_a56f6b010842cf27c0a8393ba3edfb696}} 
\index{book\_commands.py@{book\_commands.py}!confirm\_unbook\_slot@{confirm\_unbook\_slot}}
\index{confirm\_unbook\_slot@{confirm\_unbook\_slot}!book\_commands.py@{book\_commands.py}}
\doxysubsubsection{\texorpdfstring{confirm\_unbook\_slot()}{confirm\_unbook\_slot()}}
{\footnotesize\ttfamily  int book\+\_\+commands.\+confirm\+\_\+unbook\+\_\+slot (\begin{DoxyParamCaption}\item[{Update}]{update,  }\item[{Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE}]{context }\end{DoxyParamCaption})}



S\+T\+A\+TE 0 for /unbook. 


\begin{DoxyParams}{Parameters}
{\em update} & Update, Telegram parameters \\
\hline
{\em context} & Context\+Types, library status \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integer, the next state
\end{DoxyReturn}
S\+T\+A\+TE 0 for the {\ttfamily /unbook} command.

Expected callback pattern (as Reg\+Ex)\+: {\ttfamily $^\wedge$slot\+\_\+id\+:\mbox{[}0-\/9\mbox{]}$\ast$\$}

This function asks the user to confirm they want to un-\/book the selected slot, through an inline keyboard, then goes to S\+T\+A\+TE 1 \mbox{\Hypertarget{book__commands_8py_a8e1218c0f66e55536b63b1b3aefc148d}\label{book__commands_8py_a8e1218c0f66e55536b63b1b3aefc148d}} 
\index{book\_commands.py@{book\_commands.py}!my\_bookings@{my\_bookings}}
\index{my\_bookings@{my\_bookings}!book\_commands.py@{book\_commands.py}}
\doxysubsubsection{\texorpdfstring{my\_bookings()}{my\_bookings()}}
{\footnotesize\ttfamily  None book\+\_\+commands.\+my\+\_\+bookings (\begin{DoxyParamCaption}\item[{Update}]{update,  }\item[{Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE}]{context }\end{DoxyParamCaption})}



Command handler for /mybookings. 


\begin{DoxyParams}{Parameters}
{\em update} & Update, Telegram parameters \\
\hline
{\em context} & Context\+Types, library status \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
None
\end{DoxyReturn}
Command handler for the {\ttfamily /mybookings} command.

This function logs the information of all the slots associated to the current user. \mbox{\Hypertarget{book__commands_8py_ac90283b7b1597174965e082c937fbb4d}\label{book__commands_8py_ac90283b7b1597174965e082c937fbb4d}} 
\index{book\_commands.py@{book\_commands.py}!select\_event@{select\_event}}
\index{select\_event@{select\_event}!book\_commands.py@{book\_commands.py}}
\doxysubsubsection{\texorpdfstring{select\_event()}{select\_event()}}
{\footnotesize\ttfamily  int book\+\_\+commands.\+select\+\_\+event (\begin{DoxyParamCaption}\item[{Update}]{update,  }\item[{Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE}]{context }\end{DoxyParamCaption})}



S\+T\+A\+TE 0 for /events and /book. 


\begin{DoxyParams}{Parameters}
{\em update} & Update, Telegram parameters \\
\hline
{\em context} & Context\+Types, library status \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integer, the next state
\end{DoxyReturn}
S\+T\+A\+TE 0 for {\ttfamily /events} and {\ttfamily /book} commands.

Expected callback pattern (as Reg\+Ex)\+: {\ttfamily $^\wedge$fair\+\_\+id\+:\mbox{[}0-\/9\mbox{]}$\ast$\$}

This function lists to the user the events associated to the selected fair, as an inline keyboard, then goes to S\+T\+A\+TE 1 \mbox{\Hypertarget{book__commands_8py_a726c2ca54e78088db58ddd26ad01f4bc}\label{book__commands_8py_a726c2ca54e78088db58ddd26ad01f4bc}} 
\index{book\_commands.py@{book\_commands.py}!select\_fair@{select\_fair}}
\index{select\_fair@{select\_fair}!book\_commands.py@{book\_commands.py}}
\doxysubsubsection{\texorpdfstring{select\_fair()}{select\_fair()}}
{\footnotesize\ttfamily  int book\+\_\+commands.\+select\+\_\+fair (\begin{DoxyParamCaption}\item[{Update}]{update,  }\item[{Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE}]{context }\end{DoxyParamCaption})}



I\+N\+IT state for /fairs, /events and /book. 


\begin{DoxyParams}{Parameters}
{\em update} & Update, Telegram parameters \\
\hline
{\em context} & Context\+Types, library status \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integer, the next state
\end{DoxyReturn}
Conversation initializer for {\ttfamily /fairs}, {\ttfamily /events} and {\ttfamily /book} commands.

This function lists to the user all the fairs as an inline keyboard, then goes to S\+T\+A\+TE 0 \mbox{\Hypertarget{book__commands_8py_a20dd564a06bfeb9af69afe9a384ec03c}\label{book__commands_8py_a20dd564a06bfeb9af69afe9a384ec03c}} 
\index{book\_commands.py@{book\_commands.py}!select\_slot\_date@{select\_slot\_date}}
\index{select\_slot\_date@{select\_slot\_date}!book\_commands.py@{book\_commands.py}}
\doxysubsubsection{\texorpdfstring{select\_slot\_date()}{select\_slot\_date()}}
{\footnotesize\ttfamily  int book\+\_\+commands.\+select\+\_\+slot\+\_\+date (\begin{DoxyParamCaption}\item[{Update}]{update,  }\item[{Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE}]{context }\end{DoxyParamCaption})}



S\+T\+A\+TE 1 for /book. 


\begin{DoxyParams}{Parameters}
{\em update} & Update, Telegram parameters \\
\hline
{\em context} & Context\+Types, library status \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integer, the next state
\end{DoxyReturn}
S\+T\+A\+TE 1 for the {\ttfamily /book} command.

Expected callback pattern (as Reg\+Ex)\+: {\ttfamily $^\wedge$event\+\_\+id\+:\mbox{[}0-\/9\mbox{]}$\ast$\$}

This function lists to the user the dates available for the slots associated to a given event, as an inline keyboard, then goes to S\+T\+A\+TE 2 \mbox{\Hypertarget{book__commands_8py_abe121e3ead63c8f0e343f7ae041dad23}\label{book__commands_8py_abe121e3ead63c8f0e343f7ae041dad23}} 
\index{book\_commands.py@{book\_commands.py}!select\_slot\_for\_user@{select\_slot\_for\_user}}
\index{select\_slot\_for\_user@{select\_slot\_for\_user}!book\_commands.py@{book\_commands.py}}
\doxysubsubsection{\texorpdfstring{select\_slot\_for\_user()}{select\_slot\_for\_user()}}
{\footnotesize\ttfamily  int book\+\_\+commands.\+select\+\_\+slot\+\_\+for\+\_\+user (\begin{DoxyParamCaption}\item[{Update}]{update,  }\item[{Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE}]{context }\end{DoxyParamCaption})}



I\+N\+IT state for /unbook. 


\begin{DoxyParams}{Parameters}
{\em update} & Update, Telegram parameters \\
\hline
{\em context} & Context\+Types, library status \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integer, the next state
\end{DoxyReturn}
Conversation initializer for the {\ttfamily /unbook} command.

This function lists to the user the slots booked by them as an inline keyboard, then goes to S\+T\+A\+TE 0 \mbox{\Hypertarget{book__commands_8py_a0f132a7d6cf7d7f10f6a3282e7e08dd2}\label{book__commands_8py_a0f132a7d6cf7d7f10f6a3282e7e08dd2}} 
\index{book\_commands.py@{book\_commands.py}!select\_slot\_time@{select\_slot\_time}}
\index{select\_slot\_time@{select\_slot\_time}!book\_commands.py@{book\_commands.py}}
\doxysubsubsection{\texorpdfstring{select\_slot\_time()}{select\_slot\_time()}}
{\footnotesize\ttfamily  int book\+\_\+commands.\+select\+\_\+slot\+\_\+time (\begin{DoxyParamCaption}\item[{Update}]{update,  }\item[{Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE}]{context }\end{DoxyParamCaption})}



S\+T\+A\+TE 2 for /book. 


\begin{DoxyParams}{Parameters}
{\em update} & Update, Telegram parameters \\
\hline
{\em context} & Context\+Types, library status \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integer, the next state
\end{DoxyReturn}
S\+T\+A\+TE 2 for the {\ttfamily /book} command.

Expected callback pattern (as Reg\+Ex)\+: {\ttfamily $^\wedge$event\+\_\+id\+:\mbox{[}0-\/9\mbox{]}$\ast$\+:day\+:\mbox{[}0-\/9$\vert$-\/\mbox{]}$\ast$\$}

This function lists to the user the time available for the slots associated to the given event-\/date pair, as an inline keyboard, then goes to S\+T\+A\+TE 3 \mbox{\Hypertarget{book__commands_8py_a2610898bb910a07caec0db18e6e0b5a9}\label{book__commands_8py_a2610898bb910a07caec0db18e6e0b5a9}} 
\index{book\_commands.py@{book\_commands.py}!show\_event\_description@{show\_event\_description}}
\index{show\_event\_description@{show\_event\_description}!book\_commands.py@{book\_commands.py}}
\doxysubsubsection{\texorpdfstring{show\_event\_description()}{show\_event\_description()}}
{\footnotesize\ttfamily  int book\+\_\+commands.\+show\+\_\+event\+\_\+description (\begin{DoxyParamCaption}\item[{Update}]{update,  }\item[{Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE}]{context }\end{DoxyParamCaption})}



S\+T\+A\+TE 1 for /events. 


\begin{DoxyParams}{Parameters}
{\em update} & Update, Telegram parameters \\
\hline
{\em context} & Context\+Types, library status \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integer, the next state
\end{DoxyReturn}
S\+T\+A\+TE 1 for the {\ttfamily /events} command.

Expected callback pattern (as Reg\+Ex)\+: {\ttfamily $^\wedge$event\+\_\+id\+:\mbox{[}0-\/9\mbox{]}$\ast$\$}

This function logs to the user the information on the selected event, then terminates the conversation. \mbox{\Hypertarget{book__commands_8py_a86f5df99897bf0dcdf8731fb6703d965}\label{book__commands_8py_a86f5df99897bf0dcdf8731fb6703d965}} 
\index{book\_commands.py@{book\_commands.py}!show\_fair\_description@{show\_fair\_description}}
\index{show\_fair\_description@{show\_fair\_description}!book\_commands.py@{book\_commands.py}}
\doxysubsubsection{\texorpdfstring{show\_fair\_description()}{show\_fair\_description()}}
{\footnotesize\ttfamily  int book\+\_\+commands.\+show\+\_\+fair\+\_\+description (\begin{DoxyParamCaption}\item[{Update}]{update,  }\item[{Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE}]{context }\end{DoxyParamCaption})}



S\+T\+A\+TE 0 for /fairs. 


\begin{DoxyParams}{Parameters}
{\em update} & Update, Telegram parameters \\
\hline
{\em context} & Context\+Types, library status \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integer, the next state
\end{DoxyReturn}
S\+T\+A\+TE 0 for the {\ttfamily /fairs} command.

Expected callback pattern (as Reg\+Ex)\+: {\ttfamily $^\wedge$fair\+\_\+id\+:\mbox{[}0-\/9\mbox{]}$\ast$\$}

This function logs to the user the information on the selected fair, then terminates the conversation. \mbox{\Hypertarget{book__commands_8py_abb709437370f97838ddc485fdc6b28aa}\label{book__commands_8py_abb709437370f97838ddc485fdc6b28aa}} 
\index{book\_commands.py@{book\_commands.py}!unbook\_slot@{unbook\_slot}}
\index{unbook\_slot@{unbook\_slot}!book\_commands.py@{book\_commands.py}}
\doxysubsubsection{\texorpdfstring{unbook\_slot()}{unbook\_slot()}}
{\footnotesize\ttfamily  int book\+\_\+commands.\+unbook\+\_\+slot (\begin{DoxyParamCaption}\item[{Update}]{update,  }\item[{Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE}]{context }\end{DoxyParamCaption})}



S\+T\+A\+TE 1 for /unbook. 


\begin{DoxyParams}{Parameters}
{\em update} & Update, Telegram parameters \\
\hline
{\em context} & Context\+Types, library status \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
integer, the next state
\end{DoxyReturn}
S\+T\+A\+TE 1 for the {\ttfamily /unbook} command.

Expected callback pattern (as Reg\+Ex)\+: {\ttfamily $^\wedge$slot\+\_\+id\+:\mbox{[}0-\/9\mbox{]}$\ast$\$}

This function un-\/books a slot and logs the information it had, then terminates the conversation. \mbox{\Hypertarget{book__commands_8py_a80fcbff7625c75bc6dd2239369e80659}\label{book__commands_8py_a80fcbff7625c75bc6dd2239369e80659}} 
\index{book\_commands.py@{book\_commands.py}!whoami@{whoami}}
\index{whoami@{whoami}!book\_commands.py@{book\_commands.py}}
\doxysubsubsection{\texorpdfstring{whoami()}{whoami()}}
{\footnotesize\ttfamily  None book\+\_\+commands.\+whoami (\begin{DoxyParamCaption}\item[{Update}]{update,  }\item[{Context\+Types.\+D\+E\+F\+A\+U\+L\+T\+\_\+\+T\+Y\+PE}]{context }\end{DoxyParamCaption})}



Command handler for /whoami. 


\begin{DoxyParams}{Parameters}
{\em update} & Update, Telegram parameters \\
\hline
{\em context} & Context\+Types, library status \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
None
\end{DoxyReturn}
Command handler for the {\ttfamily /whoami} command.

This function logs all the information associated to the current user. 